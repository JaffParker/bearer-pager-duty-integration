(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{20:function(e,t,n){e.exports=n(36)},36:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(17),o=n(2),u="2f535b38228787320c10e556e2cf82c6aeb48a942483e5f19f",i="a725bd-pager-duty-integration-demo",l="882e24f0-4bda-11e9-a73b-6dac8ea7c0ec",s="9ea0f1-393b2d471c-b9ac1102-fd526493",b=n(1),f=((0,Object(o.factory)(i).withFunctionCall)("listEscalationPolicies"),(0,Object(o.factory)(i).withFunctionCall)("createIntegration"),n(19)),d=function(e){var t=Object(a.useState)(!1),n=Object(b.a)(t,2),c=n[0],r=n[1],u=Object(a.useState)(),l=Object(b.a)(u,2),s=l[0],f=l[1],d=Object(a.useState)(),O=Object(b.a)(d,2),j=O[0],m=O[1],p=Object(a.useContext)(o.BearerContext).bearer;return{loading:c,data:{eventResult:s},error:j,sendEvent:Object(a.useCallback)(function(t){return r(!0),p.functionFetch(i,"sendEvent",{query:{setupId:e,referenceId:t}}).then(function(e){return f(e.data),e.data}).catch(function(e){return m(e),e}).finally(function(){r(!1)})},[])}};var O,j,m=function(e){var t=Object(a.useState)(!1),n=Object(b.a)(t,2),c=n[0],r=n[1],u=Object(a.useState)(),l=Object(b.a)(u,2),s=l[0],f=l[1],d=Object(a.useState)(),O=Object(b.a)(d,2),j=O[0],m=O[1],p=Object(a.useContext)(o.BearerContext).bearer;return Object(a.useEffect)(function(){r(!0),p.functionFetch(i,"listEscalationPolicies",{query:{setupId:e}}).then(function(e){var t=e.data;f(t)}).catch(m).finally(function(){return r(!1)})},[]),{loading:c,data:{policies:s},error:j}},p=function(e){var t=Object(a.useState)(!1),n=Object(b.a)(t,2),c=n[0],r=n[1],u=Object(a.useState)(),l=Object(b.a)(u,2),s=l[0],f=l[1],d=Object(a.useState)(),O=Object(b.a)(d,2),j=O[0],m=O[1],p=Object(a.useContext)(o.BearerContext).bearer;return{loading:c,data:{referenceId:s},error:j,createIntegration:Object(a.useCallback)(function(t){return r(!0),p.functionFetch(i,"createIntegration",{query:{setupId:e},escalationPolicy:t}).then(function(e){var t=e.referenceId;return f(t),t}).catch(function(e){return m(e),e}).finally(function(){r(!1)})},[r,e,f,m])}},v=(O=function(e){var t=e.referenceId,n=e.fetch,c=e.loading,r=a.useCallback(function(){t&&n(t).then(function(e){console.log("Event details",e),alert(JSON.stringify(e))}).catch(console.error)},[n,t]);return a.createElement("button",{type:"button",disabled:!t||c,className:"btn btn-secondary",onClick:r},c?"Loading...":"Send test event")},j=l,function(e){var t=d(j),n=t.sendEvent,a=t.data,r=Object(f.a)(t,["sendEvent","data"]);return c.a.createElement(O,Object.assign({data:a.eventResult,fetch:n},e,r))});function E(){var e=a.useState(),t=Object(b.a)(e,2),n=t[0],c=t[1],r=a.useState(-1),o=Object(b.a)(r,2),u=o[0],i=o[1],f=m(l),d=f.data,O=f.loading,j=p(l),E=j.createIntegration,g=j.data.referenceId,h=a.useCallback(function(e){i(e.target.value)},[i]),y=a.useCallback(function(e){e.preventDefault(),E(n&&n[u]).then(function(e){console.log("Integration details",e)}).catch(console.error)},[E]);return a.useEffect(function(){d&&c(d.policies)},[d,c]),!n||O?a.createElement("p",null,"Fetching escalation policies..."):a.createElement("form",{style:{width:300},onSubmit:y},a.createElement("select",{className:"form-control custom-select",value:u,onChange:h},a.createElement("option",null,"Select an escalation policy"),a.createElement("option",null,"-------"),n.map(function(e,t){return a.createElement("option",{key:e.id,value:t},e.summary)})),a.createElement("button",{type:"submit",className:"btn btn-primary"},"Save settings"),a.createElement(v,{referenceId:g||s}))}var g=document.getElementById("root");Object(r.render)(a.createElement(function(){return a.createElement(o.Bearer,{clientId:u},a.createElement("div",{className:"App"},a.createElement(E,null)))},null),g)}},[[20,1,2]]]);
//# sourceMappingURL=main.0f5f9ce7.chunk.js.map